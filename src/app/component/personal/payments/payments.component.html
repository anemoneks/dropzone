<!-- ============================================================== -->
<!-- Table -->
<!-- ============================================================== -->
<div class="row">
  <!-- column -->
  <div class="col-12">
    <div class="card">
      <div class="card-body">
        <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger"
          class="table table-striped table-bordered table-sm row-border hover">
          <thead>
            <tr>
              <th>House</th>
              <th>Reference No</th>
              <th>Amount</th>
              <th>Paid On</th>
              <th>Created On</th>
              <th>Uploaded By</th>
              <th>&nbsp;</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let housePayment of housePayments">
              <td><a href="javascript: void (0);" (click)="open2(paymentModal, housePayment.payment._id)">{{
                  housePayment.house.address() }}</a></td>
              <td><a href="javascript: void (0);" (click)="open2(paymentModal, housePayment.payment._id)">{{
                  housePayment.payment.referenceNo }}</a></td>
              <td><a href="javascript: void (0);" (click)="open2(paymentModal, housePayment.payment._id)">{{
                  housePayment.payment.amount }}</a></td>
              <td><a href="javascript: void (0);" (click)="open2(paymentModal, housePayment.payment._id)">{{
                  housePayment.payment.paidDate | date }}</a></td>
              <td><a href="javascript: void (0);"
                  (click)="open2(paymentModal, housePayment.payment._id)">{{housePayment.payment.createdDate | date
                  }}</a></td>
              <td><a href="javascript: void (0);" (click)="open2(paymentModal, housePayment.payment._id)">{{
                  housePayment.payment.createdBy }}</a></td>
              <td>
                <div class="pretty p-icon">
                  <input class="form-check-input" type="checkbox" id="gridCheck" (click)="$event.stopPropagation()"
                    (change)="$event ? selection.toggle(housePayment) : null"
                    [checked]="selection.isSelected(housePayment)">
                  <div class="state">
                    <i class="icon fa fa-check"></i>
                    <label></label>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <th colspan="7">
                <div class="d-flex justify-content-end w-100">
                  <div class="p-2"><button type="button" class="btn btn-primary" (click)="open2(paymentModal, null)">Add
                      New</button>
                  </div>

                  <div class="p-2"><button type="button" class="btn btn-primary" (click)="deleteSelected()"
                      [disabled]="(selection.selected || []).length <= 0">Delete</button></div>
                </div>
              </th>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </div>
</div>
<!-- ============================================================== -->
<!-- Table -->
<!-- ============================================================== -->

<ng-template #paymentModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Add new payment</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">Ã—</span>
    </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="paymentDetailForm">
      <div formGroupName="house">
        <div class="form-row">
          <div class="form-group col-12">
            <label for="houseId">House</label>
            <div [ngClass]="{ 'border border-danger': paymentDetailForm.controls.house?._id?.errors?.required }">
              <ng-select2 [data]="select2Roles" [options]="options" [width]="500" formControlName="_id">
              </ng-select2>
            </div>
          </div>
        </div>
      </div>
      <div formGroupName="payment">
        <div class="form-row">
          <div class="form-group col-12">
            <div class="input-group">
              <input class="form-control" placeholder="yyyy-mm-dd" name="dp2" ngbDatepicker [(ngModel)]="paidDate"
                [ngClass]="{ 'border border-danger': paymentDetailForm.controls.payment.controls.paidDate?.errors?.required }"
                (ngModelChange)="onDateChange($event)" #d3="ngbDatepicker" ngModel
                [ngModelOptions]="{standalone: true}">
              <div class="input-group-append">
                <button class="btn btn-outline-secondary no-shadow" (click)="d3.toggle()" type="button">
                  <i class="fa fa-calendar"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="referenceNo">Reference No</label>
            <input class="form-control" formControlName="referenceNo"
              [ngClass]="{ 'border border-danger': paymentDetailForm.controls.payment.controls.referenceNo?.errors?.required }"
              id="referenceNo" placeholder="Reference No">
          </div>
          <div class="form-group col-md-6">
            <label for="amount">Amount</label>
            <input class="form-control" formControlName="amount"
              [ngClass]="{ 'border border-danger': (paymentDetailForm.controls.payment.controls.amount?.errors?.required || paymentDetailForm.controls.payment.controls.amount?.errors?.pattern) }"
              id="amount" placeholder="Amount">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group col-12">
            <label for="attachment">Attachment</label>
            <input type="file" class="form-control" id="attachment"
              [ngClass]="{ 'border border-danger': (paymentDetailForm.controls.payment.controls.filename?.errors?.required) }"
              (change)="handleFileInput($event.target.files)">
            {{ paymentDetailForm.controls.payment.get('filename').value }}
          </div>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.dismiss('Cross click')">Cancel</button>

    <button type="button" class="btn btn-primary" (click)="addPayment()">Ok</button>
  </div>
</ng-template>